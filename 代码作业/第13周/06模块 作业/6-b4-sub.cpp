/*2452654 郭炫君 电信*/

#include <cstdio>   //NULL
//不再允许包含任何系统头文件

/* ----- 不允许定义任何形式的全局变量/全部数组/只读全局变量/宏定义!!!!! ----- */

/* 函数实现部分，{ }内的东西可以任意调整，目前的return只是一个示例，可改变 */
/***************************************************************************
  函数名称：
  功    能：
  输入参数：
  返 回 值：
  说    明：
***************************************************************************/
int tj_strlen(const char *str)
{
    /* 注意：函数内不允许定义任何形式的数组（包括静态数组） */
    if (str == NULL) {
        return 0;
    }
    const char* p = str;
    while (*p != '\0') {
        p++;
    }
    return p-str;
}

/***************************************************************************
  函数名称：
  功    能：
  输入参数：
  返 回 值：
  说    明：
***************************************************************************/
char *tj_strcat(char *s1, const char *s2)
{
    /* 注意：函数内不允许定义任何形式的数组（包括静态数组） */
    if (s1 == NULL)
        return NULL;
    if (s2 == NULL)
        return s1;
    char* p1 = s1;
    const char* p2 = s2;
    while (*p1 != '\0') {
        p1++;
    }
    while (*p2 != '\0') {
        *p1++ = *p2++;
    }
    *p1 = '\0';

    return s1;
}

/***************************************************************************
  函数名称：
  功    能：
  输入参数：
  返 回 值：
  说    明：
***************************************************************************/
char *tj_strncat(char *s1, const char *s2, const int len)
{
    /* 注意：函数内不允许定义任何形式的数组（包括静态数组） */
    if (s1 == NULL)
        return NULL;
    if (s2 == NULL|| len<=0)
        return s1;

    char* p1 = s1;
    const char* p2 = s2;
    while (*p1 != '\0') {
        p1++;
    }
    int i = 0;
    while (i < len && *p2 != '\0') {
        *p1++ = *p2++;
        i++;
    }
    *p1 = '\0';

    return s1;
}

/***************************************************************************
  函数名称：
  功    能：
  输入参数：
  返 回 值：
  说    明：
***************************************************************************/
char *tj_strcpy(char *s1, const char *s2)
{
    /* 注意：函数内不允许定义任何形式的数组（包括静态数组） */
    if (s1 == NULL)
        return NULL;
    if (s2 == NULL) {
        *s1 = '\0';
        return s1;
    }

    char* p1 = s1;
    const char* p2 = s2;
    while (*p2 != '\0')
        *p1++ = *p2++;
    *p1 = '\0';
    return s1;
}

/***************************************************************************
  函数名称：
  功    能：
  输入参数：
  返 回 值：
  说    明：
***************************************************************************/
char *tj_strncpy(char *s1, const char *s2, const int len)
{
    if (s1 == NULL)
        return NULL;
    if (s2 == NULL||len<=0) {
        return s1;
    }

    char* p1 = s1;
    const char* p2 = s2;
    int i = 0;
    while (i < len && *p2 != '\0') {
        *p1++ = *p2++;
        i += 1;
    }

    return s1;
}

/***************************************************************************
  函数名称：
  功    能：
  输入参数：
  返 回 值：
  说    明：
***************************************************************************/
int tj_strcmp(const char *s1, const char *s2)
{
    /* 注意：函数内不允许定义任何形式的数组（包括静态数组） */
    if (s1 == NULL && s2 == NULL)
        return 0;
    if (s1 == NULL)
        return -1;
    if (s2 == NULL)
        return 1;
    const char* p1 = s1;
    const char* p2 = s2;
    while (*p1 == *p2 && *p1 != '\0' && *p2 != '\0') {
        p1++;
        p2++;
    }
    return *p1-*p2;
}

/***************************************************************************
  函数名称：
  功    能：
  输入参数：
  返 回 值：
  说    明：
***************************************************************************/
int tj_strcasecmp(const char* s1, const char* s2)
{
    /* 注意：函数内不允许定义任何形式的数组（包括静态数组） */
    if (s1 == NULL && s2 == NULL)
        return 0;
    if (s1 == NULL)
        return -1;
    if (s2 == NULL)
        return 1;
    const char* p1 = s1;
    const char* p2 = s2;

    while (*p1 != '\0' && *p2 != '\0') {
        char c1 = (*p1 >= 'A' && *p1 <= 'Z') ? *p1 + 32 : *p1;
        char c2 = (*p2 >= 'A' && *p2 <= 'Z') ? *p2 + 32 : *p2;

        if (c1 != c2)
            return c1 - c2;
        p1++;
        p2++;
    }
    char c1 = (*p1 >= 'A' && *p1 <= 'Z') ? *p1 + 32 : *p1;
    char c2 = (*p2 >= 'A' && *p2 <= 'Z') ? *p2 + 32 : *p2;
    return c1-c2;
}

/***************************************************************************
  函数名称：
  功    能：
  输入参数：
  返 回 值：
  说    明：
***************************************************************************/
int tj_strncmp(const char *s1, const char *s2, const int len)
{
    /* 注意：函数内不允许定义任何形式的数组（包括静态数组） */
    if (s1 == NULL && s2 == NULL) 
        return 0;
    if (s1 == NULL)
        return -1;
    if (s2 == NULL)
        return 1;
    if (len <= 0) 
        return 0;
    int i = 0;
    while (i < len && *s1 != '\0' && *s2 != '\0'&&*s1==*s2) {
        s1++;
        s2++;
        i++;
    }
    if (i == len)
        return 0;
    return *s1 - *s2;
}

/***************************************************************************
  函数名称：
  功    能：
  输入参数：
  返 回 值：
  说    明：
***************************************************************************/
int tj_strcasencmp(const char *s1, const char *s2, const int len)
{
    /* 注意：函数内不允许定义任何形式的数组（包括静态数组） */
    if (s1 == NULL && s2 == NULL)
        return 0;
    if (s1 == NULL)
        return -1;
    if (s2 == NULL)
        return 1;
    if (len <= 0)
        return 0;
    int i = 0;
    while (i < len && *s1 != '\0' && *s2 != '\0') {
        char c1 = (*s1 >= 'A' && *s1 <= 'Z') ? *s1 + 32 : *s1;
        char c2 = (*s2 >= 'A' && *s2 <= 'Z') ? *s2 + 32 : *s2;
        if (c1 != c2)
            return c1 - c2;
        s1++;
        s2++;
        i++;
    }
    if (i == len)
        return 0;
    char c1 = (*s1 >= 'A' && *s1 <= 'Z') ? *s1 + 32 : *s1;
    char c2 = (*s2 >= 'A' && *s2 <= 'Z') ? *s2 + 32 : *s2;
    return c1 - c2;
    return 0;
}

/***************************************************************************
  函数名称：
  功    能：
  输入参数：
  返 回 值：
  说    明：
***************************************************************************/
char *tj_strupr(char *str)
{
    /* 注意：函数内不允许定义任何形式的数组（包括静态数组） */
    if (str == NULL) 
        return NULL;
    char* p = str;
    while (*p != '\0') {
        if (*p >= 'a' && *p <= 'z')
            *p = *p - 32;
        p++;
    }
    return str;
}

/***************************************************************************
  函数名称：
  功    能：
  输入参数：
  返 回 值：
  说    明：
***************************************************************************/
char *tj_strlwr(char *str)
{
    /* 注意：函数内不允许定义任何形式的数组（包括静态数组） */
    if (str == NULL) 
        return NULL;
    char* p = str;
    while (*p != '\0') {
        if (*p >= 'A' && *p <= 'Z')
            *p = *p + 32;
        p++;
    }
    return str;
}

/***************************************************************************
  函数名称：
  功    能：
  输入参数：
  返 回 值：
  说    明：
***************************************************************************/
int tj_strchr(const char *str, const char ch)
{
    /* 注意：函数内不允许定义任何形式的数组（包括静态数组） */
    if (str == NULL)
        return 0;
    const char* p = str;
    int pos = 1;
    while (*p != '\0') {
        if (*p == ch)
            return pos;
        p++;
        pos++;
    }
    return 0;
}

/***************************************************************************
  函数名称：
  功    能：
  输入参数：
  返 回 值：
  说    明：
***************************************************************************/
int tj_strstr(const char *str, const char *substr)
{
    /* 注意：函数内不允许定义任何形式的数组（包括静态数组） */
    if (str == NULL || substr == NULL) 
        return 0;
    if (*substr == '\0') 
        return 1;

    const char* p = str;
    int pos = 1;
    while (*p != '\0') {
        const char* s1 = p;
        const char* s2 = substr;

        while (*s1 != '\0' && *s2 != '\0' && *s1 == *s2) {
            s1++;
            s2++;
        }

        if (*s2 == '\0')
            return pos;
        p++;
        pos++;
    }

    return 0;
}

/***************************************************************************
  函数名称：
  功    能：
  输入参数：
  返 回 值：
  说    明：
***************************************************************************/
int tj_strrchr(const char *str, const char ch)
{
    /* 注意：函数内不允许定义任何形式的数组（包括静态数组） */
    if (str == NULL)
        return 0;
    int len = tj_strlen(str);
    const char* p = str+len-1;
    int pos = len;
    while (p>=str) {
        if (*p == ch)
            return pos;
        p--;
        pos--;
    }

    return 0;
}

/***************************************************************************
  函数名称：
  功    能：
  输入参数：
  返 回 值：
  说    明：
***************************************************************************/
int tj_strrstr(const char *str, const char *substr)
{
    /* 注意：函数内不允许定义任何形式的数组（包括静态数组） */
    if (str == NULL || substr == NULL) 
        return 0;
    if (*substr == '\0') 
        return 1;

    int len = tj_strlen(str);
    const char* p = str+len- tj_strlen(substr);
    while (p>=str) {
        const char* s1 = p;
        const char* s2 = substr;

        while (*s1!='\0' && *s2 !='\0'&&*s1 == *s2) {
            s1++;
            s2++;
        }

        if (*s2 =='\0')
            return p-str+1;
        p--;
    }
    return 0;
}

/***************************************************************************
  函数名称：
  功    能：
  输入参数：
  返 回 值：
  说    明：
***************************************************************************/
char *tj_strrev(char *str)
{
    /* 注意：函数内不允许定义任何形式的数组（包括静态数组） */
    if (str == NULL)
        return NULL;

    char* start = str;
    char* end = str + tj_strlen(str) - 1;

    while (start < end) {
        char temp = *start;
        *start = *end;
        *end = temp;

        start++;
        end--;
    }

    return str;
}
